"""
================================================================================
                  🚀 重新生成Excel报告 - 详细步骤
================================================================================

问题: Dashboard中看不到定价毛利率和售价毛利率列
原因: Excel报告是旧版本（2025-10-29生成），代码已更新但报告未更新

解决方案: 重新运行 untitled1.py 生成新报告
================================================================================

📋 操作步骤：

步骤1: 找到原始数据文件
-----------------------
原始数据文件应该包含以下列：
  ✓ 商品名称
  ✓ 售价  
  ✓ 原价（必须！）
  ✓ cost 或 成本（必须！）
  ✓ 月售
  ✓ 一级分类

文件名可能是：
  • 淮安生态新城商品10.29.xlsx
  • 淮安生态新城商品10.29 的副本.xlsx
  • 或其他类似名称

步骤2: 运行untitled1.py
-----------------------
在PowerShell终端中执行：

    python untitled1.py

步骤3: 输入数据文件
-----------------------
当看到提示:
    【可以选】文件路径:

操作：
  1. 找到原始Excel文件
  2. 拖拽文件到终端窗口
  3. 按回车

步骤4: 等待处理完成
-----------------------
程序会显示：
  ⚙️ 开始处理...
  ✅ 文件读取成功
  ✅ 成本指标计算完成
  ✅ 分类成本聚合完成
  ...
  ✅ 报告已保存

步骤5: 验证新报告
-----------------------
检查生成的文件：
  reports/淮安生态新城商品10.29 的副本_分析报告.xlsx

新报告应该包含：
  ✓ 成本分析汇总：原价销售额、定价毛利、售价毛利率、定价毛利率
  ✓ 高毛利TOP50：原价、售价毛利率、定价毛利率  
  ✓ 低毛利预警：原价、售价毛利率、定价毛利率

步骤6: 重启Dashboard
-----------------------
  1. 关闭当前Dashboard（Ctrl+C）
  2. 重新运行: 启动Dashboard.bat
  3. 刷新浏览器
  4. 查看成本&毛利分析面板

================================================================================

⚠️ 常见问题：

Q: 找不到原始数据文件怎么办？
A: 检查以下位置：
   • 当前目录
   • 上级目录
   • 桌面
   • 下载文件夹
   使用命令搜索: Get-ChildItem -Path D:\ -Filter "*淮安*.xlsx" -Recurse

Q: 报错"缺少必要列"怎么办？
A: 确认原始文件包含 '原价' 和 'cost'(成本) 列

Q: Dashboard还是不显示新列怎么办？
A: 
   1. 确认新Excel文件修改时间是今天
   2. 确认Dashboard读取的是新文件
   3. 完全关闭并重启Dashboard
   4. 清除浏览器缓存后刷新

Q: 如何确认报告已更新？
A: 运行验证脚本: python check_report_version.py
   应该显示: ✅ Excel报告已是新版本

================================================================================
"""

print(__doc__)

# 提供快速启动命令
print("\n💡 快速启动命令:")
print("-" * 80)
print("运行: python untitled1.py")
print("然后拖拽原始Excel文件到终端")
print("-" * 80)
