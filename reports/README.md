# Reports 目录说明

## 目录用途

此目录用于存放门店分析报告Excel文件。

## 文件格式要求

### 必需的Sheet

1. **核心指标对比** (或 KPI / 核心指标)
   - 包含门店的核心KPI数据
   - 必需列：门店、总SKU数(含规格)、动销SKU数、动销率等

2. **美团一级分类详细指标** (或 一级分类详细指标 / 一级分类)
   - 包含各分类的详细统计
   - 必需列：一级分类、爆品数、折扣、动销率等

3. **价格带分析** (或 价格分析)
   - 包含价格带分布数据
   - 必需列：价格带、SKU数量、销售额等

4. **详细SKU报告(去重后)** (或 SKU报告)
   - 包含所有SKU的详细信息
   - 必需列：商品名称、售价、月售等

### 可选的Sheet

- **成本分析汇总**：成本和毛利率分析
- **高毛利商品**：高毛利商品TOP50
- **低毛利预警**：低毛利商品列表
- **商品角色分析**：引流品、利润品等分类

## 使用方法

### 1. 上传报告文件

将生成的Excel报告文件放入此目录，例如：
```
reports/
├── 淮安生态新城商品_分析报告.xlsx
├── 其他门店_分析报告.xlsx
└── README.md
```

### 2. 在Dashboard中使用

**方法1：默认报告**
- 修改 `dashboard_v2_optimized.py` 中的 `DEFAULT_REPORT_PATH`
- 指向你的报告文件

**方法2：上传功能**
- 启动Dashboard后，使用"上传分析"功能
- 直接上传Excel文件进行分析

### 3. 生成报告

使用 `untitled1.py` 生成分析报告：

```bash
python untitled1.py --inputs "原始数据.xlsx"
```

生成的报告会包含所有必需的Sheet。

## 文件命名建议

推荐使用以下命名格式：
```
{门店名称}_{日期}_分析报告.xlsx

例如：
- 淮安生态新城_20241214_分析报告.xlsx
- 南京新街口_20241214_分析报告.xlsx
```

## 注意事项

1. **文件大小**：建议单个文件不超过50MB
2. **文件格式**：必须是 `.xlsx` 格式（不支持 `.xls`）
3. **中文支持**：文件名和内容支持中文
4. **缓存机制**：相同文件会被缓存，修改后自动重新加载

## 缓存说明

Dashboard会自动缓存已加载的报告：
- 缓存位置：`./cache/`
- 缓存命名：`{文件名}_{MD5哈希}.cache`
- 自动失效：文件修改后自动重新加载
- 手动清除：删除 `./cache/` 目录

## 故障排查

### 问题1：报告加载失败

**可能原因：**
- 文件不存在或路径错误
- Excel文件损坏
- 缺少必需的Sheet

**解决方法：**
1. 检查文件路径是否正确
2. 用Excel打开文件，确认Sheet名称
3. 查看日志文件：`./logs/dashboard.log`

### 问题2：数据显示异常

**可能原因：**
- Sheet名称不匹配
- 列名不一致
- 数据格式错误

**解决方法：**
1. 确认Sheet名称符合要求
2. 检查列名是否包含必需字段
3. 清除缓存后重试：删除 `./cache/` 目录

### 问题3：缓存未生效

**可能原因：**
- 文件权限问题
- 磁盘空间不足

**解决方法：**
1. 检查 `./cache/` 目录权限
2. 确保有足够磁盘空间（至少100MB）

## 示例数据

如需测试，可以使用以下命令生成示例数据：

```bash
python create_sample_report.py
```

这会在 `reports/` 目录下创建一个示例报告文件。
