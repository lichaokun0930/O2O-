from dashboard_v2 import DataLoader

loader = DataLoader('./reports/æ·®å®‰ç”Ÿæ€æ–°åŸå•†å“10.29 çš„å‰¯æœ¬_åˆ†ææŠ¥å‘Š.xlsx')
kpi = loader.get_kpi_summary()

print('ğŸ“Š KPIæŒ‡æ ‡å®Œæ•´åˆ—è¡¨ï¼ˆåŒ…å«å•è§„æ ¼ï¼‰:')
target_keys = [
    'æ€»SKUæ•°(å«è§„æ ¼)',
    'æ€»SKUæ•°(å»é‡å)',
    'å•è§„æ ¼SPUæ•°',
    'å•è§„æ ¼SKUæ•°',
    'å¤šè§„æ ¼SKUæ€»æ•°', 
    'åŠ¨é”€SKUæ•°', 
    'æ»é”€SKUæ•°', 
    'æ€»é”€å”®é¢(å»é‡å)', 
    'åŠ¨é”€ç‡', 
    'å”¯ä¸€å¤šè§„æ ¼å•†å“æ•°', 
    'é—¨åº—çˆ†å“æ•°', 
    'é—¨åº—å¹³å‡æŠ˜æ‰£', 
    'å¹³å‡SKUå•ä»·', 
    'é«˜ä»·å€¼SKUå æ¯”', 
    'ä¿ƒé”€å¼ºåº¦', 
    'çˆ†æ¬¾é›†ä¸­åº¦', 
    'æ€»æˆæœ¬é”€å”®é¢', 
    'æ€»æ¯›åˆ©', 
    'å¹³å‡æ¯›åˆ©ç‡', 
    'é«˜æ¯›åˆ©å•†å“æ•°'
]

for k in target_keys:
    status = "âœ…" if k in kpi else "âŒ"
    value = kpi.get(k, "ç¼ºå¤±")
    print(f'  {status} {k}: {value}')

print(f'\nå®é™…è¿”å›æŒ‡æ ‡æ•°: {len([k for k in target_keys if k in kpi])}/20')
print(f'\nå¡ç‰‡é…ç½®ä¸­éœ€è¦çš„æŒ‡æ ‡: 19ä¸ªï¼ˆä¸åŒ…å«å•è§„æ ¼SPUæ•°ï¼‰')
