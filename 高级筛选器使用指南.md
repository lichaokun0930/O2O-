# 🔍 高级筛选器使用指南

## ✅ 已完成功能（第一阶段）

### 1. 筛选器UI组件
- ✅ 左侧Offcanvas侧边栏（380px宽）
- ✅ 7个筛选维度：
  - 💵 **价格区间**：¥0 - ¥500+，支持滑块拖动
  - 🎭 **商品角色**：引流品/利润品/形象品/劣势品（多选）
  - 📊 **月销量范围**：0 - 10,000+
  - 📦 **库存状态**：充足(>50)/适中(20-50)/偏低(10-20)/预警(<10)
  - 🎁 **促销类型**：有促销/有折扣/无促销
  - 🏷️ **一级分类**：继承原有分类筛选器
  - ⏰ **时间范围**：（预留接口）

### 2. 快捷筛选方案
- 🔥 **爆品分析**：月销量>1000 + 引流品/利润品
- ❄️ **滞销商品**：月销量<100
- 💰 **高毛利商品**：利润品/形象品 + 价格>¥50
- 🎁 **促销商品**：有促销活动或折扣
- ⚠️ **库存预警**：库存偏低或预警状态

### 3. 核心功能
- ✅ 实时显示筛选结果数量和占比
- ✅ 支持多维度组合筛选（AND逻辑）
- ✅ KPI卡片实时响应筛选条件
- ✅ 分类销售分析支持筛选
- ✅ 一键重置所有筛选条件
- ✅ 应用筛选后自动关闭面板

## 📖 使用方法

### 打开筛选器
1. 点击页面左上角的 **"🔍 高级筛选"** 按钮
2. 侧边栏从左侧滑出显示

### 使用快捷方案（推荐新手）
1. 点击任一快捷按钮（如"🔥 爆品分析"）
2. 系统自动填充预设条件
3. 点击"✅ 应用筛选"查看结果

### 自定义筛选条件
1. **价格筛选**：拖动滑块设置价格范围
2. **角色筛选**：从下拉框勾选目标角色
3. **销量筛选**：拖动滑块设置销量范围
4. **库存筛选**：选择一个或多个库存状态
5. **促销筛选**：选择促销类型
6. 点击"✅ 应用筛选"

### 查看筛选效果
- **实时计数**：面板底部显示"📊 筛选结果: X / Y SKU"
- **KPI更新**：所有13个KPI指标基于筛选数据重新计算
- **图表更新**：分类分析、角色分布等图表同步刷新

### 重置筛选
点击"🔄 重置"按钮清空所有筛选条件，恢复全量数据

## 🎯 典型应用场景

### 场景1：分析高价值爆品
```
操作：
1. 点击"🔥 爆品分析"
2. 手动调整价格区间至¥100-500
3. 应用筛选

效果：
- 查看高价值爆品的销售表现
- 分析高价商品的分类分布
- 评估爆品集中度
```

### 场景2：库存优化建议
```
操作：
1. 点击"⚠️ 库存预警"
2. 查看库存不足的SKU

效果：
- 识别需要补货的商品
- 评估缺货对销售的影响
- 生成补货优先级列表
```

### 场景3：促销效果评估
```
操作：
1. 点击"🎁 促销商品"
2. 查看促销商品KPI

对比：
1. 重置筛选查看全量KPI
2. 对比促销强度和销售效果
```

### 场景4：定位滞销高库存
```
操作：
1. 销量范围设置：0-100
2. 库存状态选择：充足+适中
3. 应用筛选

效果：
- 发现积压库存
- 制定促销降价策略
```

## 🚀 技术亮点

### 数据筛选逻辑
- **apply_advanced_filters(df, filter_state)**：核心筛选函数
- 支持7维度组合，AND逻辑连接
- 自动处理数据类型转换和异常值

### KPI动态计算
- **calculate_kpi_from_filtered_data(sku_df)**：从筛选数据计算KPI
- 支持13个指标的实时重算
- 包括：动销率、销售额、爆款集中度、促销强度等

### 回调优化
- 所有图表回调统一增加`advanced-filter-state`输入
- KPI、分类分析等核心模块已适配
- 筛选结果实时计数无需等待

## 📝 待完成功能（后续阶段）

### 第二阶段：全图表筛选支持
- [ ] 多规格商品供给分析
- [ ] 折扣商品分析
- [ ] 价格带分布
- [ ] 销量气泡图
- [ ] 销量树状图
- [ ] 库存健康看板
- [ ] 促销效果分析

### 第三阶段：筛选器增强
- [ ] 筛选历史记录（最近5次）
- [ ] 自定义方案保存
- [ ] 筛选条件导出为Excel
- [ ] 快捷键支持（Ctrl+F打开）

## ⚠️ 注意事项

1. **数据依赖**：需先上传Excel文件才能使用筛选器
2. **性能考虑**：大数据集（>10,000 SKU）可能有1-2秒延迟
3. **组合筛选**：条件越多，结果越精确，但可能为空
4. **重置建议**：切换数据文件后建议重置筛选器

## 🐛 已知问题

1. ~~促销类型筛选依赖X/Y列，部分数据可能无此列~~（已处理异常）
2. ~~筛选后分类分析需重新聚合数据~~（已实现）
3. 其他图表暂未适配筛选器（计划中）

## 📞 反馈与建议

如有使用问题或功能建议，请联系开发团队。

---

**版本**: v2.1.0-alpha  
**更新时间**: 2025年10月27日  
**下一步**: 竞对对比分析（MultiStoreDataLoader）
