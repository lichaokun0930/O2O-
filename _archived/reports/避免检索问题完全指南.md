# âš ï¸ é¿å…æ£€ç´¢é—®é¢˜å®Œå…¨æŒ‡å—

**é—®é¢˜**: ä¸ºä»€ä¹ˆè€æ˜¯å‡ºç°æ£€ç´¢é—®é¢˜ï¼Ÿ  
**æ ¹æº**: ç³»ç»Ÿä¸­å­˜åœ¨æ–°æ—§ä¸¤å¥—AIæ¨¡å—ï¼Œå®¹æ˜“æ··ç”¨  
**è§£å†³**: å½»åº•æ¸…ç†æ—§æ¨¡å—ï¼Œç»Ÿä¸€ä½¿ç”¨çº¯å‡€ç‰ˆ

---

## ğŸ” é—®é¢˜æ ¹æºåˆ†æ

### å½“å‰çŠ¶æ€
æ‚¨çš„ç³»ç»Ÿä¸­å­˜åœ¨**ä¸¤å¥—å¹¶è¡Œçš„AIåˆ†ææ¨¡å—**ï¼š

#### âŒ æ—§ç‰ˆï¼ˆå¤æ‚ç‰ˆï¼‰- ä¼šè§¦å‘æ£€ç´¢
- `ai_analyzer.py` - ä¾èµ–å‘é‡æ£€ç´¢
- `ai_business_context.py` - 15000+å­—ç¬¦ä¸šåŠ¡åŸºå› åº“
- `ai_knowledge_retriever.py` - å‘é‡æ£€ç´¢å¼•æ“ï¼ˆå·²å½’æ¡£ï¼‰
- `cache/business_knowledge_vectorstore/` - å‘é‡æ•°æ®åº“ç¼“å­˜

#### âœ… æ–°ç‰ˆï¼ˆçº¯å‡€ç‰ˆï¼‰- æ— æ£€ç´¢åŠŸèƒ½
- `ai_analyzer_simple.py` - åªè°ƒç”¨GLMï¼Œæ— æ£€ç´¢
- `ai_panel_analyzers_simple.py` - çº¯å‡€çœ‹æ¿åˆ†æå™¨

### ä¸ºä»€ä¹ˆä¼šå‡ºç°æ£€ç´¢é—®é¢˜ï¼Ÿ

#### åœºæ™¯1: è¯¯ç”¨æ—§ç‰ˆæ¨¡å—
```python
# é”™è¯¯ï¼šå¯¼å…¥äº†æ—§ç‰ˆ
from ai_analyzer import get_ai_analyzer  # âŒ è¿™ä¸ªä¼šå°è¯•åŠ è½½å‘é‡æ£€ç´¢

# æ­£ç¡®ï¼šåº”è¯¥ç”¨çº¯å‡€ç‰ˆ
from ai_analyzer_simple import get_ai_analyzer  # âœ… æ— æ£€ç´¢
```

#### åœºæ™¯2: å‘é‡æ£€ç´¢ä¾èµ–ç¼ºå¤±
æ—§ç‰ˆ`ai_analyzer.py`ä¼šå°è¯•åŠ è½½ï¼š
```python
from ai_knowledge_retriever import get_knowledge_retriever  # âŒ æ‰¾ä¸åˆ°æˆ–æŠ¥é”™
```

ä½†`ai_knowledge_retriever.py`å·²ç»è¢«ç§»åˆ°`_archived/deprecated/`äº†ï¼

#### åœºæ™¯3: ç¼“å­˜æ–‡ä»¶å†²çª
- æ—§ç‰ˆä¾èµ–`cache/business_knowledge_vectorstore/`
- å¦‚æœç¼“å­˜æŸåæˆ–ä¸å®Œæ•´ï¼Œä¼šæŠ¥é”™

---

## âœ… å®Œå…¨è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ç¡®ä¿ä½¿ç”¨çº¯å‡€ç‰ˆï¼ˆæ¨èï¼‰

#### æ­¥éª¤1: æ£€æŸ¥dashboard_v2.pyå¯¼å…¥
```powershell
python -c "import dashboard_v2; print('çº¯å‡€ç‰ˆ' if 'simple' in str(dashboard_v2.__file__) else 'å¯èƒ½æ··ç”¨äº†æ—§ç‰ˆ')"
```

æ‰“å¼€`dashboard_v2.py`ï¼Œç¡®è®¤**ç¬¬32-41è¡Œ**æ˜¯è¿™æ ·çš„ï¼š
```python
# âœ… æ­£ç¡®ï¼šçº¯å‡€ç‰ˆAIåˆ†ææ¨¡å—
from ai_analyzer_simple import get_ai_analyzer
# å¯¼å…¥çº¯å‡€ç‰ˆçœ‹æ¿ä¸“é¡¹AIåˆ†æå™¨
from ai_panel_analyzers_simple import (
    get_kpi_analyzer, 
    get_category_analyzer,
    get_price_analyzer,
    get_promo_analyzer,
    get_master_analyzer
)
```

å¦‚æœçœ‹åˆ°è¿™æ ·çš„ï¼Œéœ€è¦æ”¹ï¼š
```python
# âŒ é”™è¯¯ï¼šæ—§ç‰ˆå¤æ‚æ¨¡å—
from ai_analyzer import get_ai_analyzer  
from ai_business_context import get_business_context
from ai_panel_analyzers import KPIPanelAnalyzer  
```

#### æ­¥éª¤2: å½’æ¡£æ—§ç‰ˆæ¨¡å—ï¼ˆé˜²æ­¢è¯¯ç”¨ï¼‰
```powershell
# åˆ›å»ºå½’æ¡£ç›®å½•
New-Item -ItemType Directory -Force -Path ".\_archived\ai_modules_old"

# ç§»åŠ¨æ—§ç‰ˆæ¨¡å—ï¼ˆå¦‚æœè¿˜åœ¨ä¸»ç›®å½•ï¼‰
Move-Item -Force ai_analyzer.py .\_archived\ai_modules_old\
Move-Item -Force ai_business_context.py .\_archived\ai_modules_old\
Move-Item -Force ai_panel_analyzers.py .\_archived\ai_modules_old\

# å‘é‡æ£€ç´¢æ¨¡å—å·²åœ¨ _archived\deprecated\ ä¸­ï¼Œæ— éœ€å†åŠ¨
```

#### æ­¥éª¤3: æ¸…ç†å‘é‡æ£€ç´¢ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
```powershell
# å¦‚æœç¡®å®šä¸éœ€è¦å‘é‡æ£€ç´¢åŠŸèƒ½ï¼Œå¯ä»¥åˆ é™¤ç¼“å­˜é‡Šæ”¾ç©ºé—´
Remove-Item -Recurse -Force .\cache\business_knowledge_vectorstore
# é‡Šæ”¾çº¦420MBç©ºé—´
```

#### æ­¥éª¤4: éªŒè¯ç¯å¢ƒ
```powershell
# æµ‹è¯•çº¯å‡€ç‰ˆèƒ½å¦æ­£å¸¸è¿è¡Œ
python -c "from ai_analyzer_simple import get_ai_analyzer; print('âœ… çº¯å‡€ç‰ˆæ­£å¸¸')"
python -c "from ai_panel_analyzers_simple import get_kpi_analyzer; print('âœ… Panel AIæ­£å¸¸')"
```

### æ–¹æ¡ˆ2: å®Œå…¨å¯ç”¨å‘é‡æ£€ç´¢ç‰ˆï¼ˆä¸æ¨èï¼‰

å¦‚æœç¡®å®éœ€è¦å‘é‡æ£€ç´¢åŠŸèƒ½ï¼ˆä¸æ¨èï¼Œå¤æ‚ä¸”æ˜“å‡ºé”™ï¼‰ï¼š

#### å‰ææ¡ä»¶
1. å®‰è£…å®Œæ•´ä¾èµ–ï¼š
```powershell
pip install langchain langchain-community faiss-cpu sentence-transformers
```

2. æ¢å¤æ—§ç‰ˆæ¨¡å—ï¼š
```powershell
# ä»å½’æ¡£æ¢å¤
Copy-Item .\_archived\deprecated\ai_knowledge_retriever.py .\
Copy-Item .\_archived\ai_modules_old\ai_analyzer.py .\
Copy-Item .\_archived\ai_modules_old\ai_business_context.py .\
Copy-Item .\_archived\ai_modules_old\ai_panel_analyzers.py .\
```

3. ä¿®æ”¹dashboard_v2.pyå¯¼å…¥ï¼ˆæ”¹å›æ—§ç‰ˆï¼‰

4. é¦–æ¬¡å¯åŠ¨éœ€ä¸‹è½½æ¨¡å‹ï¼ˆ5-10åˆ†é’Ÿï¼‰

**âš ï¸ è­¦å‘Š**: è¿™ä¼šå¢åŠ å¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬ï¼

---

## ğŸ›¡ï¸ é˜²å¾¡æ€§ç¼–ç¨‹å»ºè®®

### 1. æ·»åŠ å¯¼å…¥æ£€æŸ¥ï¼ˆdashboard_v2.pyé¡¶éƒ¨ï¼‰

åœ¨`dashboard_v2.py`çš„å¯¼å…¥åæ·»åŠ ï¼š
```python
# å¯¼å…¥éªŒè¯ï¼šç¡®ä¿ä½¿ç”¨çº¯å‡€ç‰ˆ
try:
    from ai_analyzer_simple import get_ai_analyzer
    from ai_panel_analyzers_simple import get_kpi_analyzer
    USING_SIMPLE_VERSION = True
    print("âœ… ä½¿ç”¨çº¯å‡€ç‰ˆAIï¼ˆæ— æ£€ç´¢ï¼‰")
except ImportError:
    USING_SIMPLE_VERSION = False
    print("âŒ è­¦å‘Šï¼šçº¯å‡€ç‰ˆAIæ¨¡å—ç¼ºå¤±ï¼")
    raise
```

### 2. ç¦ç”¨æ—§ç‰ˆæ¨¡å—å¯¼å…¥ï¼ˆå¯é€‰ï¼‰

åœ¨æ—§ç‰ˆæ¨¡å—é¡¶éƒ¨æ·»åŠ å¼ƒç”¨è­¦å‘Šï¼ˆå¦‚æœè¿˜ä¿ç•™åœ¨ä¸»ç›®å½•ï¼‰ï¼š

`ai_analyzer.py`é¡¶éƒ¨æ·»åŠ ï¼š
```python
import warnings
warnings.warn(
    "æ­¤æ¨¡å—å·²å¼ƒç”¨ï¼Œè¯·ä½¿ç”¨ ai_analyzer_simple.py",
    DeprecationWarning,
    stacklevel=2
)
raise ImportError("è¯·ä½¿ç”¨çº¯å‡€ç‰ˆ: from ai_analyzer_simple import get_ai_analyzer")
```

### 3. åˆ›å»ºç¯å¢ƒæ£€æŸ¥è„šæœ¬

åˆ›å»º`check_ai_modules.py`ï¼š
```python
#!/usr/bin/env python3
"""æ£€æŸ¥AIæ¨¡å—é…ç½®æ˜¯å¦æ­£ç¡®"""

def check_modules():
    print("ğŸ” æ£€æŸ¥AIæ¨¡å—é…ç½®...\n")
    
    # æ£€æŸ¥çº¯å‡€ç‰ˆ
    try:
        from ai_analyzer_simple import get_ai_analyzer
        print("âœ… ai_analyzer_simple.py å­˜åœ¨ä¸”å¯å¯¼å…¥")
    except ImportError as e:
        print(f"âŒ ai_analyzer_simple.py å¯¼å…¥å¤±è´¥: {e}")
        return False
    
    try:
        from ai_panel_analyzers_simple import get_kpi_analyzer
        print("âœ… ai_panel_analyzers_simple.py å­˜åœ¨ä¸”å¯å¯¼å…¥")
    except ImportError as e:
        print(f"âŒ ai_panel_analyzers_simple.py å¯¼å…¥å¤±è´¥: {e}")
        return False
    
    # æ£€æŸ¥dashboardé…ç½®
    try:
        with open('dashboard_v2.py', 'r', encoding='utf-8') as f:
            content = f.read()
            if 'from ai_analyzer_simple import' in content:
                print("âœ… dashboard_v2.py ä½¿ç”¨çº¯å‡€ç‰ˆ")
            elif 'from ai_analyzer import' in content:
                print("âš ï¸ dashboard_v2.py ä½¿ç”¨æ—§ç‰ˆï¼ˆå¯èƒ½è§¦å‘æ£€ç´¢ï¼‰")
                return False
            else:
                print("â“ dashboard_v2.py AIæ¨¡å—å¯¼å…¥ä¸æ˜ç¡®")
                return False
    except Exception as e:
        print(f"âŒ æ— æ³•è¯»å–dashboard_v2.py: {e}")
        return False
    
    # æ£€æŸ¥æ—§ç‰ˆæ˜¯å¦è¿˜åœ¨ä¸»ç›®å½•
    import os
    old_modules = [
        'ai_analyzer.py',
        'ai_business_context.py', 
        'ai_knowledge_retriever.py'
    ]
    found_old = [m for m in old_modules if os.path.exists(m)]
    if found_old:
        print(f"\nâš ï¸ ä¸»ç›®å½•ä»æœ‰æ—§ç‰ˆæ¨¡å—: {found_old}")
        print("   å»ºè®®ç§»åˆ° _archived/ é˜²æ­¢è¯¯ç”¨")
    else:
        print("\nâœ… ä¸»ç›®å½•æ— æ—§ç‰ˆæ¨¡å—")
    
    print("\nâœ… AIæ¨¡å—é…ç½®æ­£ç¡®ï¼")
    return True

if __name__ == '__main__':
    import sys
    sys.exit(0 if check_modules() else 1)
```

---

## ğŸ“‹ å¿«é€Ÿæ’æŸ¥æ¸…å•

é‡åˆ°æ£€ç´¢é—®é¢˜æ—¶ï¼ŒæŒ‰æ­¤æ¸…å•é€é¡¹æ£€æŸ¥ï¼š

### [ ] 1. ç¡®è®¤dashboard_v2.pyå¯¼å…¥
```powershell
grep "from ai_analyzer" dashboard_v2.py
# åº”è¯¥çœ‹åˆ°: from ai_analyzer_simple import
# ä¸åº”è¯¥çœ‹åˆ°: from ai_analyzer import
```

### [ ] 2. ç¡®è®¤çº¯å‡€ç‰ˆæ¨¡å—å­˜åœ¨
```powershell
Test-Path ai_analyzer_simple.py
Test-Path ai_panel_analyzers_simple.py
# éƒ½åº”è¯¥è¿”å› True
```

### [ ] 3. æ£€æŸ¥æ˜¯å¦æœ‰æ—§ç‰ˆæ®‹ç•™
```powershell
Test-Path ai_knowledge_retriever.py
# åº”è¯¥è¿”å› Falseï¼ˆæˆ–åœ¨_archived/ä¸­ï¼‰
```

### [ ] 4. æµ‹è¯•çº¯å‡€ç‰ˆå¯¼å…¥
```powershell
python -c "from ai_analyzer_simple import get_ai_analyzer; a = get_ai_analyzer(); print('âœ… OK' if a else 'âŒ Fail')"
```

### [ ] 5. æ¸…ç†Pythonç¼“å­˜
```powershell
Remove-Item -Recurse -Force __pycache__
Remove-Item -Recurse -Force .pytest_cache
# é˜²æ­¢æ—§ç‰ˆ.pycæ–‡ä»¶å½±å“
```

### [ ] 6. é‡å¯Dashboard
```powershell
python dashboard_v2.py
# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼Œåº”è¯¥æ²¡æœ‰"åŠ è½½å‘é‡æ£€ç´¢"å­—æ ·
```

---

## ğŸ¯ æ¨èé…ç½®ï¼ˆå½»åº•é¿å…æ£€ç´¢é—®é¢˜ï¼‰

### æœ€ä½³å®è·µ
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ dashboard_v2.py              â† ä½¿ç”¨çº¯å‡€ç‰ˆå¯¼å…¥
â”œâ”€â”€ ai_analyzer_simple.py        â† çº¯å‡€ç‰ˆï¼ˆä¸»åŠ›ï¼‰
â”œâ”€â”€ ai_panel_analyzers_simple.py â† çº¯å‡€ç‰ˆï¼ˆä¸»åŠ›ï¼‰
â”‚
â”œâ”€â”€ _archived/                   â† å½’æ¡£æ—§ç‰ˆ
â”‚   â”œâ”€â”€ ai_modules_old/
â”‚   â”‚   â”œâ”€â”€ ai_analyzer.py       â† å¤æ‚ç‰ˆï¼ˆå½’æ¡£ï¼‰
â”‚   â”‚   â”œâ”€â”€ ai_business_context.py
â”‚   â”‚   â””â”€â”€ ai_panel_analyzers.py
â”‚   â””â”€â”€ deprecated/
â”‚       â””â”€â”€ ai_knowledge_retriever.py â† å‘é‡æ£€ç´¢ï¼ˆå·²åºŸå¼ƒï¼‰
â”‚
â””â”€â”€ cache/                       â† å¯åˆ é™¤
    â””â”€â”€ business_knowledge_vectorstore/ â† ä¸å†ä½¿ç”¨
```

### å¯åŠ¨è„šæœ¬ä¿®æ”¹

`å¯åŠ¨Dashboard.bat`:
```batch
@echo off
chcp 65001
echo å¯åŠ¨Dashboardï¼ˆçº¯å‡€AIç‰ˆï¼Œæ— æ£€ç´¢ï¼‰...
python dashboard_v2.py
pause
```

---

## ğŸš¨ å¸¸è§é”™è¯¯åŠè§£å†³

### é”™è¯¯1: ModuleNotFoundError: No module named 'ai_knowledge_retriever'
**åŸå› **: dashboard_v2.pyä»åœ¨ä½¿ç”¨æ—§ç‰ˆå¯¼å…¥  
**è§£å†³**: æ”¹ç”¨`from ai_analyzer_simple import`

### é”™è¯¯2: ImportError: cannot import name 'get_knowledge_retriever'
**åŸå› **: ai_analyzer.pyä¾èµ–å‘é‡æ£€ç´¢æ¨¡å—  
**è§£å†³**: ä½¿ç”¨ai_analyzer_simple.pyæ›¿ä»£

### é”™è¯¯3: FileNotFoundError: [Errno 2] No such file or directory: 'cache/business_knowledge_vectorstore'
**åŸå› **: æ—§ç‰ˆå°è¯•åŠ è½½ä¸å­˜åœ¨çš„å‘é‡åº“  
**è§£å†³**: åˆ‡æ¢åˆ°çº¯å‡€ç‰ˆæˆ–é‡å»ºå‘é‡åº“

### é”™è¯¯4: RuntimeError: Failed to load embedding model
**åŸå› **: HuggingFaceæ¨¡å‹ä¸‹è½½å¤±è´¥  
**è§£å†³**: ä¸éœ€è¦åµŒå…¥æ¨¡å‹ï¼Œä½¿ç”¨çº¯å‡€ç‰ˆå³å¯

---

## âœ… éªŒè¯æˆåŠŸæ ‡å¿—

è¿è¡Œ`python dashboard_v2.py`åï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
âœ… çº¯å‡€ç‰ˆAIåˆ†æå™¨å·²å°±ç»ª (glm-4-plus)
âœ… KPIçœ‹æ¿åˆ†æå™¨å·²å°±ç»ª
âœ… åˆ†ç±»çœ‹æ¿åˆ†æå™¨å·²å°±ç»ª
âœ… ä»·æ ¼å¸¦çœ‹æ¿åˆ†æå™¨å·²å°±ç»ª
âœ… ä¿ƒé”€çœ‹æ¿åˆ†æå™¨å·²å°±ç»ª
âœ… ä¸»AIç»¼åˆåˆ†æå™¨å·²å°±ç»ª
```

**ä¸åº”è¯¥çœ‹åˆ°**ï¼š
```
âŒ æ­£åœ¨åŠ è½½å‘é‡æ£€ç´¢æ¨¡å—...
âŒ Downloading embedding model...
âŒ æ„å»ºå‘é‡æ•°æ®åº“...
```

---

## ğŸ“ é—®é¢˜å‡çº§è·¯å¾„

å¦‚æœæŒ‰ä¸Šè¿°æ–¹æ³•ä»æœ‰é—®é¢˜ï¼š

1. **è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬**
```powershell
python check_ai_modules.py
```

2. **æŸ¥çœ‹å®Œæ•´é”™è¯¯æ ˆ**
```powershell
python dashboard_v2.py 2>&1 | Out-File dashboard_error.log
# æŸ¥çœ‹ dashboard_error.log
```

3. **æä¾›è¯Šæ–­ä¿¡æ¯**
```powershell
# ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
python -c "
import sys
print(f'Pythonç‰ˆæœ¬: {sys.version}')
print(f'å·¥ä½œç›®å½•: {__import__(\"os\").getcwd()}')

import importlib.util
modules = ['ai_analyzer_simple', 'ai_analyzer', 'ai_knowledge_retriever']
for m in modules:
    spec = importlib.util.find_spec(m)
    print(f'{m}: {\"å­˜åœ¨\" if spec else \"ä¸å­˜åœ¨\"} ({spec.origin if spec else \"N/A\"})')
"
```

---

## ğŸ‰ æ€»ç»“

### æ ¹æœ¬åŸå› 
- æ–°æ—§ä¸¤å¥—AIæ¨¡å—å¹¶å­˜
- æ—§ç‰ˆä¾èµ–å‘é‡æ£€ç´¢ï¼Œæ–°ç‰ˆä¸ä¾èµ–
- æ··ç”¨æˆ–è¯¯ç”¨å¯¼è‡´æ£€ç´¢é”™è¯¯

### å½»åº•è§£å†³
1. âœ… **ç»Ÿä¸€ä½¿ç”¨çº¯å‡€ç‰ˆ**ï¼ˆai_analyzer_simple.pyï¼‰
2. âœ… **å½’æ¡£æ—§ç‰ˆæ¨¡å—**ï¼ˆç§»åˆ°_archived/ï¼‰
3. âœ… **æ¸…ç†æ£€ç´¢ç¼“å­˜**ï¼ˆå¯é€‰ï¼Œé‡Šæ”¾ç©ºé—´ï¼‰
4. âœ… **éªŒè¯å¯¼å…¥é…ç½®**ï¼ˆdashboard_v2.pyï¼‰

### é¢„é˜²æªæ–½
- æ·»åŠ å¯¼å…¥æ£€æŸ¥ä»£ç 
- åˆ›å»ºç¯å¢ƒæ£€æŸ¥è„šæœ¬
- å®šæœŸè¿è¡ŒéªŒè¯æ¸…å•

---

**åˆ›å»ºæ—¶é—´**: 2025å¹´10æœˆ29æ—¥  
**é€‚ç”¨ç‰ˆæœ¬**: Dashboard v2.0+  
**AIæ¨¡å¼**: çº¯å‡€ç‰ˆï¼ˆæ¨èï¼‰

